
<p-dialog [(visible)]="isModalCreateVisible" (onHide)="closeModalCreate()" [modal]="true" styleClass="h-auto w-full md:w-9 lg:w-6 sm:mx-2" contentStyle="h-auto" id="createEventModal" >

    <div *ngIf="isLoading" >
        <app-loader />
    </div>
    <p-tabView [activeIndex]="activeIndexTab">
        <p-tabPanel [disabled]="isDisabledEventTab">
            <ng-template pTemplate="header">
                <span class="text-xl font-bold">Evento</span>
            </ng-template>

            <div class="">
                <form [formGroup]="createEventForm" class="grid gap-3" >

                    <div class="col-12">
                        <span class="p-float-label w-full">
                            <p-dropdown (onChange)="changeCreateEventForm($event )" [options]="eventFormats ? eventFormats : []" formControlName="eventFormatId" optionLabel="name" optionValue="id" placeholder="Selecciona un formato para este evento" styleClass="w-full"  inputId="eventFormatId"></p-dropdown>
                            <label for="eventFormatId">Selecciona un formato</label>
                        </span>
                    </div>
    
                    <div class="col-12">
                        <span class="p-float-label w-full">
                            <p-dropdown  [options]="eventCategories" formControlName="eventCategoryId" optionLabel="name" optionValue="id" placeholder="Selecciona una categoría para este evento" styleClass="w-full"  inputId="eventCategory"></p-dropdown>
                            <label for="eventCategory">Selecciona una categoría</label>
                        </span>
                    </div>
        
        
                    <div class="col-12" >
                        <span class="p-float-label w-full ">
                            <input pInputText id="username" formControlName="title" class="w-full" />
                            <label htmlFor="username">Titulo</label>
                        </span>
                    </div>
        
                    <div class="col-12" >
                        <span class="p-float-label w-full">
                            <input pInputText id="username" formControlName="description" class="w-full" />
                            <label htmlFor="username">Descripción</label>
                        </span>
                    </div>
        
                    <div class=" col-6 flex mb-3" >
                        <p-checkbox [binary]="true" label="Será privado?" formControlName="isPrivate"></p-checkbox>
                    </div>
        
                    <div *ngIf="!isVirtual" class="col-12">
                            <span class="p-float-label w-full">
                                <input pInputText id="place" formControlName="place" class="w-full" />
                                <label for="place">Lugar</label>
                            </span>
                    </div>
                   
        
                    <div *ngIf="isVirtual" class="col-12">
                        <span class="p-float-label w-full">
                            <input pInputText id="link" formControlName="link" class="w-full" />
                            <label for="link">Link</label>
                        </span>
                    </div>
        
                    <div class="col-12" >
                        <span class="p-float-label w-full">
                            <p-calendar  [showSeconds]="false" id="dateTime"  formControlName="dateTime" [showTime]="true"  inputStyleClass="w-full"  [panelStyle]="{'margin-top': '200px'}" ></p-calendar>
                            <label for="dateTime">Fecha y Hora</label>
                        </span>
                    </div>
        
        
                    <div class="col-12">
                        <span class="p-float-label w-full">
                            <p-dropdown [options]="communities" formControlName="communityId" optionLabel="name" optionValue="id" placeholder="Selecciona una comunidad" styleClass="w-full"  inputId="community"></p-dropdown>
                            <label for="community">Selecciona una comunidad</label>
                        </span>
                    </div>
        
                  
        
                    <div class="col-12" >
                        <label htmlFor="score" class="text-400">
                            Puntaje
                        </label>
                        <span class="p-float-label w-full">
                            <p-inputNumber 
                                inputId="locale-us" 
                                locale="en-US" 
                                id="score" 
                                inputId="integeronly" 
                                inputId="minmax" 
                                [showButtons]="true" 
                                inputId="minmax-buttons"  
                                [min]="1" 
                                [max]="100" 
                                formControlName="score" 
                                styleClass="w-full" 
                            />
                        </span>
                    </div>
        
                    <div class="w-full flex justify-content-end ">
                        <p-button [loading]="isLoading" (click)="createEvent()" icon="pi pi-check"  label="Crear" styleClass="p-button-rounded p-button-sm"></p-button>
                    </div>
                    
                    
                </form>
            </div>
        </p-tabPanel>
        <p-tabPanel *ngIf="!createEventForm.get('link')?.value" [disabled]="isDisabledConsumableTab">
            <ng-template pTemplate="header">
                <span class="text-xl font-bold">Consumible</span>
            </ng-template>
        
            <form [formGroup]="consumableForm" class="grid gap-3">
            
                <div formArrayName="consumables" class="col-12  h-25rem overflow-y-scroll mb-5 mt-5">
                    <div class="flex justify-content-between align-items-center">
                        <span class="text-500" *ngIf="consumablesControls.controls.length > 0">Consumibles para este evento</span>
                        <p-button label="Agregar consumible" styleClass="p-button-outlined p-button-sm"
                            (onClick)="addConsumable()"></p-button>
                    </div>
            
                    <div class="col-12 flex gap-2 align-items-center"
                        *ngFor="let consumable of consumablesControls.controls; let i = index">
                        <span class="p-float-label w-full">
                            <input pInputText id="consumable" [formControlName]="i" class="w-full" placeholder="Consumible {{i + 1}}" />
                        </span>
                        <p-button icon="pi pi-times" (onClick)="removeConsumable(i)"
                            styleClass="p-button-rounded p-button-danger p-button-sm">
                        </p-button>
                    </div>
                </div>|
            
                <p-button [loading]="isLoading" (click)="createConsumables()" icon="pi pi-check" label="Crear"
                    styleClass="p-button-rounded absolute bottom-0 right-0 m-2"></p-button>
            
            </form>
        
        </p-tabPanel>
    
    </p-tabView>
</p-dialog>
<p-toast [breakpoints]="{'920px': {width: '100%', right: '0', left: '0'}}"></p-toast>

